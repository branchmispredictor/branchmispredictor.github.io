<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.121.2"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>branchmispredictor</title>
<meta name=description content><meta name=author content="branchmispredictor"><link rel=canonical href=https://branchmispredictor.github.io/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://branchmispredictor.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://branchmispredictor.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://branchmispredictor.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://branchmispredictor.github.io/apple-touch-icon.png><link rel=mask-icon href=https://branchmispredictor.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://branchmispredictor.github.io/index.xml><link rel=alternate type=application/json href=https://branchmispredictor.github.io/index.json><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="branchmispredictor"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://branchmispredictor.github.io/"><meta property="og:site_name" content="branchmispredictor"><meta name=twitter:card content="summary"><meta name=twitter:title content="branchmispredictor"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"branchmispredictor","url":"https://branchmispredictor.github.io/","description":"","thumbnailUrl":"https://branchmispredictor.github.io/favicon.ico","sameAs":["https://github.com/branchmispredictor"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://branchmispredictor.github.io/ accesskey=h title="branchmispredictor (Alt + H)">branchmispredictor</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://branchmispredictor.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://branchmispredictor.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://branchmispredictor.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://branchmispredictor.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Encrypted ZFS Root Key on USB using Arch</h2></header><div class=entry-content><p>This is an initcpio hook that loads your root pool zfs password from a usb stick, as an alternative to modifying the zfs initcpio hook as mentioned in https://wiki.archlinux.org/title/Install_Arch_Linux_on_ZFS#Loading_password_from_USB-Stick.
This hook can also be used in ZFSBootMenu, meaning the same code and same usb can unlock your root pool in ZFSBootMenu and Linux itself. This solution does not store your key in initramfs.
Generate the Password + Write to the USB Generate your zfs password and put it on a usb drive using DD, see the first two steps: https://wiki....</p></div><footer class=entry-footer><span title='2023-01-05 23:30:42 -0400 -0400'>2023-01-05</span>&nbsp;路&nbsp;2 min&nbsp;路&nbsp;branchmispredictor</footer><a class=entry-link aria-label="post link to Encrypted ZFS Root Key on USB using Arch" href=https://branchmispredictor.github.io/post/encrypted-zfs-root-key-on-usb-using-arch/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Fixing LSI SAS Card After Kernel Upgrade</h2></header><div class=entry-content><p>After updating my Arch Linux server to kernel version 5.14.14, all of the drives attached through a LSI SAS Card (LSISAS2116) disappeared.
TL;DR: The fix was to add mpt3sas.max_queue_depth=10000 as a kernel param.
Investigation The lines in question via dmesg:
mpt2sas_cm0: sense pool(0x(____ptrval____)) - dma(0x10d000000): depth(29868), element_size(96), pool_size (2800 kB) mpt2sas_cm0: sense pool(0x(____ptrval____))- dma(0x10d000000): depth(29868),element_size(96), pool_size(0 kB) mpt2sas_cm0: reply pool(0x(____ptrval____)) - dma(0x10d400000): depth(30191), frame_size(128), pool_size(3773 kB) mpt2sas_cm0: config page(0x(____ptrval____)) - dma(0x10cfc9000): size(512) mpt2sas_cm0: Allocated physical memory: size(66932 kB) mpt2sas_cm0: Current Controller Queue Depth(29865),Max Controller Queue Depth(32455) mpt2sas_cm0: Scatter Gather Elements per IO(128) random: fast init done mpt2sas_cm0: LSISAS2116: FWVersion(20....</p></div><footer class=entry-footer><span title='2021-11-04 23:30:42 -0400 -0400'>2021-11-04</span>&nbsp;路&nbsp;4 min&nbsp;路&nbsp;branchmispredictor</footer><a class=entry-link aria-label="post link to Fixing LSI SAS Card After Kernel Upgrade" href=https://branchmispredictor.github.io/post/fixing-lsi-sas-card-new-kernel/></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://branchmispredictor.github.io/>branchmispredictor</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>